---

name: progressive-scaffolding

description: 通过结构化选项帮用户搭建认知脚手架，将模糊需求转化为清晰方案。支持模板预置、预览确认、唯一文件保存。

version: 3.0.0

author: jcy52200

---


# 渐进式脚手架技能

## 使用场景
当用户提出一个**复杂、需要逐步细化的任务**（如开发一个系统、设计一个方案、制定一个计划等）时，**立即启动本技能**，通过选项式提问引导用户逐步澄清需求。本技能特别适合产品经理、开发者、需求分析师等需要将模糊需求转化为可落地方案的场景。

## 核心原则
- **选项格式**：所有提问必须使用 **A/B/C…** 的格式，每个选项清晰描述一种可能的情况。选项数量建议控制在 3~6 个，保持简洁。  
- **备注支持**：每次提问后提示用户**可在选项后附加自由文本备注**，以补充选项未覆盖的细节。  
- **动态规划**：**不要预先制定完整的问题列表**。每次只构思当前最关键的提问，根据用户选择实时调整后续流程。  
- **语种自适应**：在接收到用户第一次输入时，自动识别其使用的语言，并在整个交互过程中全程使用该语言。  
- **预览确认**：信息收集充分后，先输出简略版方案供用户确认，用户认可后再生成正式方案。  
- **唯一文件命名**：最终保存的 Markdown 文件必须使用**绝对唯一的文件名**（格式：`方案_YYYYMMDD_HHMMSS_四位随机数.md`），避免覆盖历史文件。

---

## 【新增】模板系统 (Templates)

为了提升不同领域的适配效率，技能内置了**模板系统**，支持预置问题流程和输出格式。模板文件存放在 `templates/` 文件夹中，AI 可根据用户任务关键词自动选择匹配模板，或让用户手动指定。

### 模板文件夹结构
```
templates/
├── software-dev/ # 软件开发领域
│ ├── questions.yaml # 预置问题流程（可选）
│ └── output-template.md # 输出模板
├── event-planning/ # 活动策划领域
│ ├── questions.yaml
│ └── output-template.md
├── product-design/ # 产品设计领域
│ └── output-template.md
└── default/ # 默认通用模板
└── output-template.md
```
### 模板使用机制
1. **自动匹配**：AI 根据用户初始描述中的关键词（如“开发系统”“策划活动”“设计产品”），自动选择对应领域的模板。若匹配失败，则使用 `default/` 模板。
2. **手动指定**：用户可随时输入“使用 [领域] 模板”切换模板。
3. **问题流程加载**：若模板中包含 `questions.yaml`，AI 可将其作为提问起点，但仍需根据用户选择动态调整后续问题（模板仅提供初始框架，不替代动态规划）。
4. **输出格式应用**：最终生成方案时，AI 需按照所选模板的 `output-template.md` 格式组织内容，确保输出风格统一、专业。

### 模板文件示例
**`templates/software-dev/output-template.md`**：

```markdown
# 【项目名称】技术方案

## 1. 需求背景
{在此处简述用户原始需求}

## 2. 技术选型
- **后端框架**：{SpringBoot / Django / Node.js...}
- **数据库**：{MySQL / PostgreSQL / MongoDB...}
- **前端技术**：{React / Vue / 无需前端...}
- **部署方式**：{云服务器 / 容器化 / 本地...}

## 3. 核心模块
{根据轮询结果列出主要功能模块}

## 4. 数据模型
{核心实体及关系说明}

## 5. 开发计划
{按阶段划分的任务清单及预估工时}
```


## 执行步骤

### 1. 识别任务与语种识别
- 用户提出一个复杂任务（例如：“我要做一个基于SpringBoot的饮品点单系统”）。  
- **立即识别用户消息的语种**，并以此语言作为后续所有交互的语言。  
- **不要进行开放式提问**，直接进入第一个轮询问题。

### 2. 启动轮询
- **第一个问题**必须紧扣任务的核心维度，以选项形式呈现。例如：  
  - 对于系统开发，第一个问题可以是关于**系统类型**或**主要用户群体**的选项。  
  - 每个提问都必须包含标准选项（A、B、C…），并额外包含 **Z. 撤销上一步的选择**（如果当前是第一个问题，则无需提供 Z 选项）。  
  - 提示用户：“请选择对应选项（可多选或单选），也可在选项后添加您的备注。”

### 3. 迭代细化与撤销处理
- 提出一个多选问题后，等待用户输入。  
- **处理用户输入**：
  - 如果用户选择 **Z**：回退到上一个问题（即重新显示上一个问题及其选项），并允许用户重新选择。AI 需要从状态栈中弹出上一次的选择记录。  
  - 如果用户选择其他选项（可能附带备注）：记录当前选择，并推入状态栈。根据新的选择重新评估任务状态，确定下一个最需要澄清的方面。  
- 重复以上过程，直到 AI 判断已收集足够信息，可以构建完整解决方案。

### 4. 预览与确认
- 当信息收集充分时，AI 生成一个**简略版方案**（例如关键要点列表或摘要），并以当前语种呈现给用户。  
- 同时询问：“这是根据您的选择生成的初步方案，请确认是否满足需求？如有需要修改的地方，请告知。”  
- 如果用户提出修改意见，AI 根据意见调整方案，并再次提供预览。可以允许用户通过描述希望修改的部分（例如“把A选项改成B”），AI 理解后更新方案。  
- 重复预览-修改循环，直到用户明确表示满意（例如“确认无误”）。

### 5. 生成最终方案并保存（唯一文件名）
- 用户确认后，AI 将完整方案整理成**格式优美的 Markdown 文档**。  
- 文档应包含：标题、需求背景、轮询过程中收集的关键信息、最终的定制解决方案。  
- **文件名生成规则（必须遵守）**：  
  - 文件名格式：`解决方案_YYYYMMDD_HHMMSS_XXXX.md`  
    - `YYYYMMDD`：当前年月日（例如 20250321）  
    - `HHMMSS`：当前时分秒（例如 143022）  
    - `XXXX`：一个四位随机数或递增序号（例如 0001、a3f8），确保即使同一秒内生成多个文件也不会重复。  
  - 如果环境支持，AI 也可以使用 UUID 或时间戳加微秒。  
  - **严禁使用固定文件名**（如 `解决方案.md`），也不应依赖用户手动命名（除非用户明确要求）。  
- **保存位置**：将文件保存到当前工作目录的**根目录**下。  
- 如果因权限或其他原因无法写入文件，则提示用户：“无法自动保存文件，请手动复制以下内容并保存为 Markdown 文件（建议使用唯一命名）。”然后将完整方案内容展示给用户。  
- 最后告知用户文件已生成，并附上完整文件路径。

## 注意事项
- **强制轮询启动**：一旦检测到用户提出复杂任务（如“我要做…”、“我需要设计…”、“帮我规划…”），**必须立即以选项问题开始**，不得先进行开放式提问。  
- **状态栈管理**：AI 需要隐式维护一个栈结构，记录每一步的问题和用户选择。当用户选择 Z 时，弹出栈顶，并重新呈现上一个问题（包括其所有选项）。如果栈为空（即第一步），则忽略 Z 选项或提示用户已是第一步。  
- **语种识别**：可使用简单的启发式方法（如检测常用词、字符范围）判断用户语言。识别后所有后续对话（包括选项文本、提示语、预览和最终方案）都使用该语言。若用户中途切换语言，AI 应能自适应并提示已切换。  
- **预览内容**：预览方案应简明扼要，突出关键决策点，避免一次性展示过多细节。用户确认后生成的正式方案则要详尽完整。  
- **文件唯一性**：生成文件名时，务必包含足够随机/时间信息。如果 AI 无法获取精确时间，可使用伪随机数生成器，并检查当前会话中是否已生成过同名文件（通过记忆），若有则添加后缀。  
- **友好交互**：在每次提供选项时，提醒用户 Z 撤销功能的存在，尤其在前几步。保持语气耐心、鼓励备注。

## 示例交互（唯一文件名演示）
> **用户**：我要做一个基于SpringBoot的饮品点单系统。  
> **AI**（检测到中文）：“好的，我们开始规划这个系统。首先，这个系统的主要使用对象是？  
> A. 顾客（点单前端）  
> B. 店员（后台管理）  
> C. 两者都需要  
> D. 仅提供API接口  
> （您可在选项后添加备注，例如“C，但先做后台”）  
> **如需撤销上一步，请输入 Z**。”  
> **用户**：C，主要是给顾客用，但后台也需要基础管理功能。  
> **AI**：“明白。接下来，您希望系统包含哪些核心功能？  
> A. 商品展示与点单  
> B. 购物车  
> C. 订单管理  
> D. 支付接口  
> E. 会员积分  
> （可多选，也可附加备注）  
> Z. 撤销上一步”  
> ...（继续轮询直至预览确认）  
> **AI**（预览确认后）：“已将完整方案保存为 `解决方案_20250321_153022_8f3a.md`，位于当前文件夹根目录。”


## 引用资源
- **模板文件夹**：`templates/`  
  - 预置各领域问题流程与输出格式
- **知识库文件夹**：`knowledge/`  
  - 存放各领域的专业知识文档（如设计模式、数据库优化等）  
  - 若用户开启了网络增强功能，AI 会根据知识库内容丰富其回答。  
- **脚本文件夹**：`scripts/`  
  - 存放辅助脚本，如：  
    - 知识库同步脚本：用于将外部知识库内容导入到本地知识库文件夹。  
    - 格式转换脚本：将生成的 Markdown 文件转换为其他格式（如 PDF、Word 等）。  
    - 批量处理脚本：批量处理多个文件（如批量转换、批量重命名等）。  